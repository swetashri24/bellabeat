---
title: "Bellabeat Marketing Strategy"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center")

```

<style>
body {
text-align: justify}
</style>

## Ask

Bellabeat a company providing fitness products such as Bellabeat app, Leaf, watch , water bottle and personal guidance wants to access the current trends in the usage of fitness devices. Their main business task to be addressed is developing a marketing strategy for Bellabeat products. This marketing strategy is proposed to be developed on the basis of the current usage of trends provided by users of another fitness device named "Fitbit".

### Questions
Questions to be mainly answered from this analysis are:\
\
1.  What are the current trends in smart device usage?\
2.  How could these trends apply to Bellabeat customers?\
3.  How could these trends influence Bellabeat Marketing strategy?\

### Data source

Fitbit user database provided by Mobius.This dataset was generated by respondents to a distributed survey via Amazon Mechanical Turk. This database consists of daily usage data of 33 users for the period April 12, 2016- May 12, 2016. These users consented to the submission of personal tracker data. This data includes minute-level output for physical activity, heart rate, and sleep monitoring. It includes information about daily activity, steps, and heart rate.



## Prepare

This data was downloaded from a Kaggle data set provided by Mobius. The data is organized as a set of 18 csv files. The users consented to provide their personal fitness data and it hides individual information.
Mainly 5 data sets have been used here. They are:\
1. Daily activity of users\
2. Hourly intensities of users\
3. Hourly steps of users\
4. User sleep data\
5. Heart rate per seconds of recorded user activity\


## Process

Using RStudio for cleaning data. This tool is being user here as it can help in cleaning, analyzing and visualizing data. Rstudio is also be used for documentation.

### Cleaning data

The following packages were installed in R to read and clean data: \
1.tidyverse\
2.tidyr\
3.dplyr\
4.lubridate\

Steps followed in cleaning: \
1. Data checked for any null values.\
2. Type of each column in the dataset is checked to make sure it is compatible with analysis and visualization.\

## Analyze  
Data was analyzed using: \
1. Histograms\
2. Pivot tables\
3. Heat maps\
4. Column graphs\

## Share

The analyzed data are simultaneously visualized below. The key observations from each visualization are noted below them. 

## Combined Cleaning, Analyzing and Visualization Step

The process adopted for cleaning, analyzing and visualizing are explained along with their corresponding code chunks\


A set of basic packages were installed and loaded in R

```{r}
library(readr) # reads a csv file`
library(tidyverse) # for data cleaning and processing
library(tidyr) # for data cleaning and processing
library(dplyr) # for data processing
library(lubridate) # date and time processing
library(yarrr) # statistical functions
library(ggplot2)#graphical functions
```


### Understanding daily activity and user behavior

The file dailyActivity_merged contains daily data. An ini`tial inspection of data is done.

```{r}
daily_activity<-read_csv("./Fitbit_data/dailyActivity_merged.csv") #reading file and assigning it to a dataframe
head(daily_activity) # show top few rows
glimpse(daily_activity) # gives a glimpse of the data types, number of columns  
```
\
The glimpse() function shows the type of the data. Here Id (User Id) is considered a "double" and ActivityDate (Date) is considered character. Changing the type of column in dataframe for cleaning. \

```{r}
# dropping n/a values 
daily_activity%>%
  drop_na()%>%
 str(daily_activity) # gives data types in column
```
\
Dropping unnecessary columns

```{r}
daily_activity<-daily_activity%>%
  dplyr::select(-TrackerDistance,-LoggedActivitiesDistance,-SedentaryActiveDistance)
str(daily_activity)
```
\
Creating a new dataframe with required column type

```{r}
Day_week<-transform(daily_activity,ActivityDate=as.Date(as.character(daily_activity[[2]]),"%m/%d/%y"))
Day_week<-transform(Day_week,Id=as.character(as.double(Day_week[[1]])))
str(Day_week)
```
\
Changing column names to maintaining naming consistency

```{r}
colnames(Day_week)[colnames(Day_week) == "FairlyActiveMinutes"] <- "ModeratelyActiveMinutes"
glimpse(Day_week)
```
\
Converting date to day of week\

```{r}
Day_week<-transform(Day_week,day_of_week=weekdays(Day_week$ActivityDate))
glimpse(Day_week)
```
\
Ordering day of week to get the right visualization \

```{r}
Day_week$rev_ord.x <- factor(Day_week$day_of_week, ordered=TRUE, levels = c("Sunday", "Saturday", "Friday", "Thursday", "Wednesday","Tuesday","Monday"))

```
\
Normalizing the activity in terms of weeks to understand Total steps taken by user in a day

```{r}
Day_week$week_no<-as.numeric(format(Day_week$ActivityDate,"%W")) 
Day_week$norm_week<-1+(Day_week$week_no-min(Day_week$week_no))

```

#### Steps taken by user and their characteristics in terms of days
\
Generating a heat map representing total steps by each user in a day

```{r,fig.width=20, fig.height=20, fig.align='center'}
 
ggplot(Day_week, aes(x=norm_week, y=rev_ord.x, fill = TotalSteps)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="blue", high="green") +  xlab("Activity Week") + ylab("Day of week") + ggtitle("Daily Steps") + labs(fill = "Total Steps")+
    theme_bw()+theme(axis.text.x = element_text(angle=90,size=7), axis.text.y = element_text(angle=0,size=30),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=25), legend.key.size = unit(2, 'cm'),legend.key.height = unit(2, 'cm'), legend.key.width = unit(2, 'cm'),legend.title = element_text(size=25))+
  scale_x_continuous(breaks=round(seq(min(Day_week$norm_week),max(Day_week$norm_week),by=1),1))+theme(plot.title = element_text(hjust = 0.5))


```
\
Observations:\
1. Users very likely to move more or have more steps on a Thursday.\ 
2. Only 1-2 users consistently moved above 30000 steps a day.\
3. About ~15 users moved around 10000 steps a day.\
4. Most users appear to move significant steps on Sunday, Monday and Thursday.\

\
Breakdown of daily steps are further studied by day of week.\
Here, the minimum, maximum and average steps are calculated for each day based on all on all the data provided by the user on that day.\
The steps taken on each day are classified to count number of datasets with zero steps on each day, steps less than 10000, steps between 10000 and 20000. \

```{r}
# classifying steps and data in terms of days of week
steps_data<-Day_week%>%
  group_by(Days_of_week=rev_ord.x)%>%
  summarise(min_steps=min(TotalSteps),max_steps=max(TotalSteps),avg_steps=mean(TotalSteps), steps_lessthan_10k=sum(TotalSteps<10000), steps_morethan_20k=sum(TotalSteps>20000), steps_zero=sum(TotalSteps==0), steps_between_10_20k=(sum(TotalSteps>10000) - sum(TotalSteps>20000)))
head(steps_data)
```

Evaluating minimum, maximum and average steps
```{r}
steps_data_summary<- steps_data %>%
  dplyr::select(-steps_lessthan_10k,-steps_zero,-steps_morethan_20k,-steps_between_10_20k)%>%
  gather(Total, Value,-Days_of_week)
steps_data_summary$Days_of_week<-ordered(steps_data_summary$Days_of_week,  levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
```


Plot for steps
```{r}
ggplot(data=steps_data_summary,aes(x=Days_of_week,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Steps summary on the basis of days",x="Day of Week",y="Steps taken",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Steps taken by users"))+
  scale_fill_manual(values=c("red", "navyblue", "blueviolet"), name="Steps taken",breaks=c("min_steps", "avg_steps", "max_steps"),labels=c("Minimum steps", "Average steps", "Maximum steps"))+
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title=element_text(face="bold"))

```
\
Observations: \
1. Minimum steps moved by users is zero. \
2. Users move an average of 7000-8000 steps a day. \
3. Maximum steps moved by user is 36019.  \

Understanding user steps trends on different days of week \

```{r}
# generating data frame for step ranges on different days of week
steps_data_plot<- steps_data%>%
  dplyr::select(-min_steps,-max_steps,-avg_steps)%>%
  gather(Total, Value,-Days_of_week)

steps_data_plot$Days_of_week<-ordered(steps_data_plot$Days_of_week,  levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
steps_data_plot$Total<-ordered(steps_data_plot$Total,  levels=c("steps_zero", "steps_lessthan_10k", "steps_between_10_20k", "steps_morethan_20k"))
```
\
Plot for steps moved

```{r}
ggplot(data=steps_data_plot,aes(x=Days_of_week,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Steps moved on the basis of days",x="Day of Week",y="Frequency",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Steps taken by users"))+
  scale_fill_manual(values=c("red", "navyblue", "blueviolet", "darkgreen"), name="Steps taken",breaks=c("steps_zero", "steps_lessthan_10k", "steps_between_10_20k", "steps_morethan_20k"),labels=c("Zero", "<10000", "10000-20000",">20000"))+
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title=element_text(face="bold"))

```
\
Observations:  \
1. Users exhibit a general tendency to move less than 10000 steps daily. \
2. High likelihood of moving below 10000 steps is on Mondays and Tuesdays. \
3. Among users moving 10000-20000 daily, they are very likely to move more on a Sunday. \
4. Among users moving above 20000 steps, the likelihood of this movement is high on a Thursday. \ 
5. Among users that move less, likelihood to not move (zero steps) is on Sunday or Tuesday. \

#### Trends in calories burned

Generating heat map representing daily calories burned

```{r, fig.height=20, fig.width=20, fig.align='center'}
ggplot(Day_week, aes(x=norm_week, y=rev_ord.x, fill = Calories)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="yellow", high="red") +  xlab("Activity Week") + ylab("Day of week") + ggtitle("Daily Calories") + labs(fill = "Calories burned")+
  theme_bw()+theme(axis.text.x = element_text(angle=90,size=7), axis.text.y = element_text(angle=0,size=30),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=25), legend.key.size = unit(2, 'cm'),legend.key.height = unit(2, 'cm'), legend.key.width = unit(2, 'cm'),legend.title = element_text(size=25))+
  scale_x_continuous(breaks=round(seq(min(Day_week$norm_week),max(Day_week$norm_week),by=1),1))+theme(plot.title = element_text(hjust = 0.5))
  
```
\
Observations:  \
1. About ~5 users burned calories intensively suggesting very few users follow intensive workout regime. \
2. High calories burned among users is mainly on a Sunday or Monday. \

Segregating calorie ranges in terms of days of week \
```{r}
calories_data<-Day_week%>%
  group_by(Days_of_week=rev_ord.x)%>%
  summarise(calories_zero=sum(Calories==0),calories_lessthan1k=sum(Calories<1000),  calories_between_1_3k=(sum(Calories>1000) - sum(Calories>3000)), calories_morethan_3k=sum(Calories>3000))%>%
  gather(Total, Value,-Days_of_week)
calories_data$Days_of_week<-ordered(calories_data$Days_of_week,  levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
calories_data$Total<-ordered(calories_data$Total,  levels=c("calories_zero", "calories_lessthan1k", "calories_between_1_3k", "calories_morethan_3k"))

head(calories_data)
```
Plot for calories

```{r}
ggplot(data=calories_data,aes(x=Days_of_week,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Steps moved on the basis of days",x="Day of Week",y="Frequency",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Calories burned by users"))+
  scale_fill_manual(values=c("red", "navyblue", "blueviolet", "darkgreen"), name="Calories burned",breaks=c("calories_zero", "calories_lessthan1k", "calories_between_1_3k", "calories_morethan_3k"),labels=c("Zero", "<1000", "1000-3000",">3000"))+
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title=element_text(face="bold"))

```
\
Observations: \
1. Among all users, 1000-3000 calories were commonly burned in a day. It was observed to be high on Monday and Sunday.\
2. Few users showed calories burned above 3000 in a day. The most was observed on Monday, Thursday and Sunday. \


#### Trends in daily sedentary minutes

Heat map representation for daily Sedentary Minutes

```{r, fig.height=20, fig.width=20, fig.align='center'}
ggplot(Day_week, aes(x=norm_week, y=rev_ord.x, fill = SedentaryMinutes)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="yellow", high="red") +  xlab("Activity Week") + ylab("Day of week") + ggtitle("Daily Sedentary Minutes") + labs(fill = "Sedentary Minutes")+
  theme_bw()+theme(axis.text.x = element_text(angle=90,size=7), axis.text.y = element_text(angle=0,size=30),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=25), legend.key.size = unit(2, 'cm'),legend.key.height = unit(2, 'cm'), legend.key.width = unit(2, 'cm'),legend.title = element_text(size=25))+
  scale_x_continuous(breaks=round(seq(min(Day_week$norm_week),max(Day_week$norm_week),by=1),1))+
  theme(plot.title = element_text(hjust = 0.5))
```
\
Observations: \
1. Users are more Sedentary on Sundays. \
2. Users are least Sedentary on Tuesdays and Fridays. \

Understanding day wise data of sedentary duration\

```{r}
sedentary_data<-Day_week%>%
  group_by(Days_of_week=rev_ord.x)%>%
  summarise(sedentary_zero=sum(SedentaryMinutes==0),sedentary_lessthan500=sum(SedentaryMinutes<1000),  sedentary_between_500_1k=(sum(SedentaryMinutes>500) - sum(SedentaryMinutes>1000)), sedentary_morethan_1k=sum(SedentaryMinutes>1000))%>%
  gather(Total, Value,-Days_of_week)
sedentary_data$Days_of_week<-ordered(sedentary_data$Days_of_week,  levels=c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
sedentary_data$Total<-ordered(sedentary_data$Total,  levels=c("sedentary_zero", "sedentary_lessthan500", "sedentary_between_500_1k", "sedentary_morethan_1k"))

head(sedentary_data)
```

```{r, fig.align='center'}
ggplot(data=sedentary_data,aes(x=Days_of_week,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Sedentary minutes on the basis of days",x="Day of Week",y="Frequency",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Sedentary Minutes range"))+
  scale_fill_manual(values=c("red", "lightblue", "blueviolet", "darkgreen"), name="Sedentary minutes",breaks=c("sedentary_zero", "sedentary_lessthan500", "sedentary_between_500_1k", "sedentary_morethan_1k"),labels=c("Zero", "<500", "500-1000",">1000"))+
    theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title=element_text(face="bold"))
```
\
Observations: \
1. Many users are sedentary for more than 1000 minutes a week. \
2. Most sedentary behaviour is observed on a Sunday. \
3. Least sedentary behaviour is observed on Thurday. \



#### Trends in daily intensities of activity of each user

Understanding daily Intensities of each user in terms of lightly, moderately and very active minutes \

```{r}
#creating data frame to classify intensities
Active_Intensities<-Day_week%>%
  gather(Total,Value,-TotalSteps,-TotalDistance,-SedentaryMinutes,-ActivityDate,-Id,-day_of_week,-rev_ord.x,-week_no,-norm_week,-LightActiveDistance,-ModeratelyActiveDistance,-LightActiveDistance,-VeryActiveDistance,-Calories)

```

```{r, fig.height=15,fig.width=15,fig.align='center'}
ggplot(data=Active_Intensities,aes(x=ActivityDate,y=Value,fill=Total))+
  geom_col(position="dodge")+
  facet_wrap(~Id)+
  theme_minimal()+
  theme(axis.text.x = element_text(angle=90,size=10), axis.text.y = element_text(angle=0,size=15),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=15),legend.title = element_text(size=20))+
  labs(title="Trends in Daily Active Minutes",x="Activity Date",y="Daily Active Minutes")+
  guides(fill=guide_legend(title="Types of Active Minutes"))+
  scale_fill_manual(values=c("#FF6600", "#66FFFF", "#0000FF"), name="Types of Active Minutes",breaks=c("LightlyActiveMinutes", "ModeratelyActiveMinutes", "VeryActiveMinutes"),labels=c("Lightly Active Minutes", "Moderately Active Minutes", "Very Active Minutes"))+
  theme(plot.title = element_text(hjust = 0.5), legend.position ="top" )

```
\
Observations: \
1. Almost all users were lightly active suggesting they keep moving throughout the day. \
2. About 12 users were consistently very active throughout the duration of the study . \
3. About 14 users exhibit consistent moderate daily activity. \


### Sumarized daily activity 

Summarizing daily data of each user using pivot tables \

Creating a pivot table to summarize activity of each user Deleting irrelevant information from Day_week dataframe \
Keeping relevant column from the existing dataframes and analyzing the results from pivot table \
```{r}
daily_activity1<-Day_week%>%
  dplyr::select(-day_of_week,-rev_ord.x,-week_no,-norm_week)
str(daily_activity1)
```

Pivot table to summarize average activity per day of each user

```{r}
library(lessR) # package to compute pivot tables
```

```{r}
pivot_daily_activity<-pivot(data=daily_activity1,mean,c(TotalSteps,TotalDistance, VeryActiveDistance, ModeratelyActiveDistance,LightActiveDistance, VeryActiveMinutes,ModeratelyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes,Calories),by=Id)
```

```{r}
str(pivot_daily_activity)
```

Number of activity days/data by each user


```{r}
library(epiDisplay)#package for histogram
tab1(pivot_daily_activity$TotalSteps_n, cum.percent = TRUE, main = 'Number of daily activity data provided by users', xlab='Number of days of activity')
```
\
Observations: \
1. About 29 users consistently used the Fitbit device for over 26 days. \
2. About 21 users used the Fitbit device for 31 days. \
3. 4 users used the device for less than 26 days. \ 


#### Summarized representation of daily activity variables

```{r}
pivot_daily_activity_refined <- pivot_daily_activity%>%
  dplyr::select(-TotalSteps_n,-TotalSteps_na,-TotalDistance_n,-TotalDistance_na,-VeryActiveDistance_n,-VeryActiveDistance_na,-ModeratelyActiveDistance_n,-ModeratelyActiveDistance_na,-LightActiveDistance_n,-LightActiveDistance_na,-VeryActiveMinutes_n,-VeryActiveMinutes_na,-ModeratelyActiveMinutes_n,-ModeratelyActiveMinutes_na,-LightlyActiveMinutes_n,-LightlyActiveMinutes_na,-SedentaryMinutes_n,-SedentaryMinutes_na,-Calories_n,-Calories_na)

str(pivot_daily_activity_refined)
```

Generating histogram to represent average distance moved daily

```{r}

hist(pivot_daily_activity_refined$TotalDistance_mean, ylim=c(0,20), xlim=c(0,15),col=yarrr::transparent("blue", trans.val = .9), main='Average daily distance', xlab='Distance')
hist(pivot_daily_activity_refined$LightActiveDistance_mean, col=yarrr::transparent("orange", trans.val = 0.5), add=TRUE)
hist(pivot_daily_activity_refined$VeryActiveDistance_mean, col=yarrr::transparent("green", trans.val = .5), add=TRUE)
hist(pivot_daily_activity_refined$ModeratelyActiveDistance_mean,  col=yarrr::transparent("white", trans.val = .1), add=TRUE)
legend('topright', c('Total Distance', 'Very Active Distance', 'Moderately Active Distance', 'Lightly Active Distance'), fill=c(yarrr::transparent("blue", trans.val = .9), yarrr::transparent("green", trans.val = .5), yarrr::transparent("orange", trans.val = 0.5), yarrr::transparent("white", trans.val = .1)), title="Daily Average")
```
\
Observations: \
Unit of distance was not provided in the data. It could most likely be in miles. \
1. About 10 users moved an average daily distance of 5 units. \
2. About 19 users moved a very actively for an average distance of 1 units daily. \
3. About 24 users moved moderately for an average distance of 4 units daily. \
4. Moderate activity was common among users. \


Average daily activity minutes by user \
```{r}
hist(pivot_daily_activity_refined$SedentaryMinutes_mean, ylim=c(0,20), xlim=c(0,1440),col=yarrr::transparent("grey", trans.val = 0), main='Average daily activity in minutes', xlab='Minutes')
hist(pivot_daily_activity_refined$LightlyActiveMinutes_mean, col=yarrr::transparent("orange", trans.val = 0.5), add=TRUE)
hist(pivot_daily_activity_refined$VeryActiveMinutes_mean, col=yarrr::transparent("green", trans.val = .5), add=TRUE)
hist(pivot_daily_activity_refined$ModeratelyActiveMinutes_mean,  col=yarrr::transparent("white", trans.val = .2), add=TRUE)
legend('topright', c('Sedentary', 'Very Active', 'Moderately Active', 'Lightly Active'), fill=c(yarrr::transparent("grey", trans.val = 0), yarrr::transparent("green", trans.val = .5), yarrr::transparent("orange", trans.val = 0.5), yarrr::transparent("white", trans.val = .2)), title="Daily Average")
```
\
Observations: \
1. Users exhibit an average of 600-1400 sedentary minutes daily. \
2. Moderate activity is prominent among users.  \
3. User activity showing long sedentary minutes suggests that they wore the fitness device to work and sleep. \

Setting the scale of graph to exclude sedentary minutes \

```{r}
hist(pivot_daily_activity_refined$SedentaryMinutes_mean, ylim=c(0,20), xlim=c(0,400),col=yarrr::transparent("grey", trans.val = 0), main='Average daily activity in minutes', xlab='Minutes')
hist(pivot_daily_activity_refined$LightlyActiveMinutes_mean, col=yarrr::transparent("orange", trans.val = 0.5), add=TRUE)
hist(pivot_daily_activity_refined$VeryActiveMinutes_mean, col=yarrr::transparent("green", trans.val = .5), add=TRUE)
hist(pivot_daily_activity_refined$ModeratelyActiveMinutes_mean,  col=yarrr::transparent("white", trans.val = .2), add=TRUE)
legend('topright', c('Sedentary', 'Very Active', 'Moderately Active', 'Lightly Active'), fill=c(yarrr::transparent("grey", trans.val = 0), yarrr::transparent("green", trans.val = .5), yarrr::transparent("orange", trans.val = 0.5), yarrr::transparent("white", trans.val = .2)), title="Daily Average")
```
Observations:\
1. On an average users were moderately active for 200 minutes daily. \
2. Most users were very active for 10 minutes daily. \
3. Moderate activity seemed common among users. \

#### Average steps and calories of users

Histogram of steps per day

```{r}
hist(pivot_daily_activity_refined$TotalSteps_mean, ylim=c(0,10), xlim=c(0,20000),col=yarrr::transparent("blue", trans.val = 0), main=' Average daily steps', xlab='Average Daily Steps')

```
```{r}
mean(pivot_daily_activity_refined$TotalSteps_mean)
```
\
Observations: \
1. Average daily steps of all users was ~7519. \
2. Users moved an average of 0-18000 steps daily. \


Histogram of average daily Calories

```{r}
hist(pivot_daily_activity_refined$Calories_mean, ylim=c(0,10), xlim=c(1000,4000),col=yarrr::transparent("orange", trans.val = 0), main='Average daily calories', xlab='Average Daily Calories')
```

```{r}
mean(pivot_daily_activity_refined$Calories_mean)
```
\
Observations: \
1. Users burned an average of 2282 calories daily. \
2. Average daily calories each user was in the range 1500-3500.  \


Relation between average total steps and average calories \

```{r}
ggplot(data=pivot_daily_activity_refined)+
  geom_point(mapping=aes(x=Calories_mean, y=TotalSteps_mean))+
  xlab("Average calories") + ylab("Average daily steps") + ggtitle("Relation between the average daily calories and average daily steps")+xlim(1000,4000)+ylim(0,20000)
```
\
Observations:\
1. Average calories burned daily and average daily steps do not have a linear relationship suggesting there are other factors influencing the calories burned daily. \


### Correlation between different daily variables
```{r}
library(ggcorrplot) #package to plot correlation plot
```

```{r}
cor_plot<-dplyr::select_if(pivot_daily_activity_refined,is.numeric)

```

```{r}
correlation_average_daily_activity<-cor(cor_plot, use="complete.obs")
round(correlation_average_daily_activity,2)

```


```{r, fig.width=10, fig.height=10}
ggcorrplot(correlation_average_daily_activity, 
           hc.order = TRUE, 
           type = "lower",
           lab = TRUE)+
  labs(title = "Correlation plot")+
  theme(plot.title = element_text(face="bold", hjust=0.5, size = 20), axis.title = element_text(face = "bold"))
```
Observations:\

This plot establishes a linear relationship between: \
1. Total distance and total steps \
2. Lightly active distance and lightly active minutes \
3. Moderately active distance and moderately active minutes \
4. Very active distance and very active minutes \



This correlational plot is further represented by relational scatter plots between all variables and density plots

```{r, fig.width=15, fig.height=15}
library(GGally) #package for scatter plot matrices
# custom function for density plot
my_density <- function(data, mapping, ...){
  ggplot(data = data, mapping = mapping) + 
    geom_density(alpha = 0.5,
                 fill = "cornflowerblue", ...)
}

# custom function for scatterplot
my_scatter <- function(data, mapping, ...){
  ggplot(data = data, mapping = mapping) + 
    geom_point(alpha = 0.5,
               color = "cornflowerblue") + 
    geom_smooth(method=lm, 
                se=FALSE, ...)
}


# create scatterplot matrix
ggpairs(cor_plot, 
        lower=list(continuous = my_scatter), 
        diag = list(continuous = my_density)) +
  labs(title = "Correlation and Density Plots Average Daily Activity Variables") + theme(plot.title = element_text(face="bold", hjust=0.5, size=20))
  theme_bw()
```
\
Observations: \
1. This graph verifies observations from the previous correlation graph. \
2. The density curves verifies observations from the histograms represented above. \

### Hourly activity trends 

#### Trends in hourly intensities

Hourly intensities heat map very plotted and analyzed to know the probable time that a user is most likely to be active

```{r}
hourly_intensities<-read_csv("./Fitbit_data/hourlyIntensities_merged.csv")
```

```{r}
glimpse(hourly_intensities)
```

```{r}
#cleaning file and converting data types
time_intensities<-hourly_intensities%>%
  drop_na()%>%
  transform(Date_time=mdy_hms(as.character(hourly_intensities$ActivityHour)))

```

```{r}

str(time_intensities)

```

```{r}
time_intensities$date<-as.Date(time_intensities$Date_time)

time_intensities$time<-format(as.POSIXct(time_intensities$Date_time),format="%H:%M:%S")

str(time_intensities)
```

```{r}
glimpse(time_intensities)
```
\
Representing hourly intensities with a heat map\

```{r, fig.width=15, fig.height=15}
ggplot(time_intensities, aes(x=date, y=time, fill = TotalIntensity)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="white", high="red") +  xlab("Activity Date") + ylab("Time of day (hrs)") + ggtitle("Hourly Intensities") + labs(fill = "Intensities range")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle=90,size=5), axis.text.y = element_text(angle=0,size=20),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=15), legend.key.size = unit(1, 'cm'),legend.key.height = unit(1, 'cm'), legend.key.width = unit(1, 'cm'),legend.title = element_text(size=15))
```
\
Observations: \

1. Each user has a different movement and exercise regime, so hourly intensities heat map does not project a general trend. \
2. Reading of intensities being close to zero from ~00:00-07:00 hrs suggests users use fitbit even while sleeping. \

Classifying intensity of activity in different ranges based on time of day\
```{r}
hourly_intensity_data<-time_intensities%>%
  group_by(hour_of_day=time)%>%
  summarise(hour_zero=sum(TotalIntensity==0),intensity_lessthan50=sum(TotalIntensity<50),  intensity_between_50_100=(sum(TotalIntensity>50) - sum(TotalIntensity>100)), intensity_morethan_1k=sum(TotalIntensity>100))%>%
  gather(Total, Value,-hour_of_day)
hourly_intensity_data$Total<-ordered(hourly_intensity_data$Total,  levels=c("hour_zero", "intensity_lessthan50", "intensity_between_50_100", "intensity_morethan_1k"))

head(hourly_intensity_data)
```

```{r}
ggplot(data=hourly_intensity_data,aes(x=hour_of_day,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Hourly Intensities",x="Time of day (hrs)",y="Frequency",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Intensity range"))+
  scale_fill_manual(values=c("red", "lightblue", "blueviolet", "darkgreen"), name="Intensity",breaks=c("hour_zero", "intensity_lessthan50", "intensity_between_50_100", "intensity_morethan_1k"),labels=c("Zero", "<50", "50-100",">100"))+theme(axis.text.x = element_text(angle=90,size=10))+
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title = element_text(face = "bold"))
```
\
Observations: \
1. Users exhibit low intensities (<50) throughout the day. \
2. Zero intensities are significant between 23:00-5:00 hrs. \
3. Moderate and high intensities of activity are observed between 5:00-23:00 hrs. \
4. Significant moderate and high intensities of activity are observed between 10:00-20:00 hrs. \

#### Trends in hourly steps

Hourly steps data was read from a .csv and was processed for analysis

```{r}
hourlySteps_merged <- read_csv("./Fitbit_data/hourlySteps_merged.csv")
```

```{r}
drop_na(hourlySteps_merged)
head(hourlySteps_merged)
```

```{r}
str(hourlySteps_merged)
```

```{r}
# changing type of data sets
hourlySteps<-hourlySteps_merged%>%
  transform(Date_time=mdy_hms(as.character(hourlySteps_merged$ActivityHour)))
```

```{r}
hourlySteps$date<-as.Date(hourlySteps$Date_time)

hourlySteps$time<-format(as.POSIXct(hourlySteps$Date_time),format="%H:%M:%S")
```

```{r}
str(hourlySteps)
```
```{r}
max(hourlySteps$StepTotal) #max hourly step
```

Plot for hourly steps

```{r, fig.width=15,fig.height=15}
ggplot(hourlySteps, aes(x=date, y=time, fill = StepTotal)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="white", high="blue") +  xlab("Activity Date") + ylab("Time of day (hrs)") + ggtitle("Hourly Total Steps") + labs(fill = "Hourly Steps")+
  theme_bw()+theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle=90,size=5), axis.text.y = element_text(angle=0,size=20),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=15), legend.key.size = unit(1, 'cm'),legend.key.height = unit(1, 'cm'), legend.key.width = unit(1, 'cm'),legend.title = element_text(size=15))
```
\
Observations:\
Similar to the previous heatmap for hourly intensities, users do not show a common trend in terms of hourly steps. \

Classifying hourly steps into ranges based on time of day 
```{r}
hourlySteps_data<-hourlySteps%>%
  group_by(hour_of_day=time)%>%
  summarise(steps_zero=sum(StepTotal==0),steps_lessthan2500=sum(StepTotal<2500),  steps_between_2500_5000=(sum(StepTotal>2500) - sum(StepTotal>5000)), steps_between_5000_7500=(sum(StepTotal>5000) - sum(StepTotal>7500)), steps_morethan_7500=sum(StepTotal>7500))%>%
  gather(Total, Value,-hour_of_day)
hourlySteps_data$Total<-ordered(hourlySteps_data$Total,  levels=c("steps_zero", "steps_lessthan2500", "steps_between_2500_5000", "steps_between_5000_7500","steps_morethan_7500"))

head(hourlySteps_data)
```

```{r}
ggplot(data=hourlySteps_data,aes(x=hour_of_day,y=Value,fill=Total))+
  geom_col(position="dodge")+
  theme_minimal()+
  labs(title="Hourly Steps",x="Time of day",y="Frequency",caption="Fitbit Data by Mobius")+
  guides(fill=guide_legend(title="Steps range"))+
  scale_fill_manual(values=c("red", "lightblue", "blueviolet", "lightgreen","darkgreen"), name="Steps",breaks=c("steps_zero", "steps_lessthan2500", "steps_between_2500_5000", "steps_between_5000_7500","steps_morethan_7500"),labels=c("Zero", "<2500", "2500-5000","5000-7500",">7500"))+theme(axis.text.x = element_text(angle=90,size=10))+
  theme(plot.title = element_text(hjust = 0.5, face = "bold"), axis.title = element_text(face = "bold"))
```
\
Observations: \
1. Users move less between 00:00-06:00 hrs. \
2. Users show significant movement (hourly steps>2500) between 08:00-22:00 hrs.\

### Sleep activity among users

Reading sleep data provided, cleaning and processing it\
```{r}
minuteSleep_merged <- read_csv("./Fitbit_data/minuteSleep_merged.csv")
drop_na(minuteSleep_merged)
head(minuteSleep_merged)
```

```{r}
#changing type of columns in dataframe
minuteSleep<-minuteSleep_merged%>%
  transform(Date_time=mdy_hms(as.character(minuteSleep_merged$date)))
```

```{r}
minuteSleep$date_activity<-as.Date(minuteSleep$Date_time)

minuteSleep$time<-format(as.POSIXct(minuteSleep$Date_time),format="%H:%M:%S")

minuteSleep$time<- as.POSIXct(minuteSleep$time, format="%H:%M:%S")
minuteSleep$Id<-as.character(minuteSleep$Id)
str(minuteSleep)

```

#### Statistics of Sleep data provided by users 

```{r}
Count_sleepdata <- minuteSleep%>%
  count(Id,date_activity)
head(Count_sleepdata)

```

```{r}
SleepCount_per_Id<-Count_sleepdata%>%
  count(Id)
str(SleepCount_per_Id)

```

```{r}
library(epiDisplay)
tab1(SleepCount_per_Id$n, cum.percent = TRUE, main = 'Daily sleep data provided by users', xlab='Number of days of sleep')
```
\
Observations:\
1. Total 24 users provided sleep data of which about 12 users provided sleep data for 25 days and above. \
2. Reason for lower data could be : (a) User charges device at night or (b) It is cumbersome to use the device while sleeping. \

#### Hourly sleep levels of users

Representing sleep data of users in terms of sleep levels

```{r, fig.width=20, fig.height=20}
ggplot(minuteSleep, aes(x=date_activity, y=time, fill = value)) + 
  geom_tile(colour = "white") + facet_grid(~Id) + scale_fill_gradient(low="gray", high="blue") +  xlab("Activity Date") + ylab("Time of day (hrs)") + ggtitle("Sleep Monitor") + labs(fill = "Sleep levels")+
  theme_bw()+theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle=90,size=5), axis.text.y = element_text(angle=0,size=20),axis.text=element_text(size=35),axis.title=element_text(size=35,face="bold"), title = element_text(size=40,face="bold"), legend.text = element_text(size=15), legend.key.size = unit(1, 'cm'),legend.key.height = unit(1, 'cm'), legend.key.width = unit(1, 'cm'),legend.title = element_text(size=15))+
  scale_y_datetime(date_breaks = "2 hours", date_labels="%H:%M")
  
```
\
Observations:\
1. Users seem to have different sleep hours and duration. \
2. Users consistently sleep between 02:00-06:00 hrs.\
3. Unlike while being awake, not all users wear the fitness device to sleep regularly. \
4. Only 1 user exhibits consistent level 3 in sleep data. \

### Heart rate data

Understanding the importance of heart rate data obtained in Fitbit among users
```{r}
#loading relevant file and cleaning
heartrate_seconds_merged <- read_csv("./Fitbit_data/heartrate_seconds_merged.csv")
head(heartrate_seconds_merged)
```

```{r}
#cleaning and changing type of data in columns of dataframe
heartrate_seconds<-heartrate_seconds_merged%>%
  drop_na()%>%
  transform(Date_time=mdy_hms(as.character(heartrate_seconds_merged$Time)))
```

```{r}
heartrate_seconds$date_activity<-as.Date(heartrate_seconds$Date_time)
heartrate_seconds$Id<-as.character(heartrate_seconds$Id)
```

```{r}

Count_heartdata <- heartrate_seconds%>%
  count(Id,date_activity)
head(Count_heartdata)

```

```{r}
Heartdata_per_Id<-Count_heartdata%>%
  count(Id)
str(Heartdata_per_Id)
```

#### Statistics of heart rate data provided by users
```{r}
tab1(Heartdata_per_Id$n, cum.percent = TRUE, main = 'Daily heartrate data provided by users')
```
\
Observations: \
1. About 14 users provided heart rate data. \
2. Among these users only 7 users provided data for above 27 days. \
3. Lesser data suggests, users are not as keen in recording/sharing heart rate per second as much as their intensities of activities. \


### Consolidated Trends and Observations
1. In a day, users move an average of ~7500 steps. \
2. Minimum steps moved is zero and and maximum steps moved is 36019.\
3. User activity recorded a common movement of 0-10000 steps daily. It was highest on Mondays and Tuesdays.\
4. Users very less likely to move above 20000 steps daily. \
5. User activity exhibited a high movement of 10000-20000 steps on a Sunday. \
6. User activity showed significant movement (steps>20000) on a Thursday. \
7. Most users burned 1000-3000 calories daily. The trends show high calories burned on Sundays and Mondays. \
8. Few user data sets suggest daily calories above 3000. Average daily calories of all users is 2282. \
9. User activity exhibited most sedentary behavior on Sundays and least sedentary behavior on Mondays. \
10. Almost all users were lightly active daily and many of them showed moderate activity. \
11. Among all 33 users, 21 users showed usage for 31 days, 8 users showed activity for 26-30 days and 4 users showed activity for less than 26 days. \
12. Users moved an average daily distance of 5 units. \
13. Moderate activity was common among all users daily. \
14. Average daily calories and steps do not show a linear relation suggesting factors other than steps influence daily calories. \
15. Hourly activity trends show that each user have different practices of activity and movement. \
16. Users show significant moderate and high intensities between 10 am -8 pm. \
16. Users exhibit significant movement between 8 am - 10 pm daily.  \
17. Less or almost zero intensity/steps between 11 pm-6 am suggests that users wear Fitbit to bed. \
18. Not many users have reported sleep activity. This may be due to charging of Fitbit or inconvenience in wearing it during sleep. \
19. User sleep activity is consistent between 2-6 am. \
20. Only 14 users consented to provide heart rate data. Lesser data suggests, users are not as keen in recording/sharing heart rate per second as much as their intensity of activities. \

### Shortcomings with Fitbit
  The following points can be used to improve development of new line of Bellabeat products. \
  1. Standard steps per hour in a Fitbit are programmed and the device gives an hourly cue to move. There are times you could be busy in not in a condition to move. General notifications during busy hours could be disturbing. \
  2. As Fitbit device is worn on the hand, steps are falsely counted by mere hand movement, for example while cooking and performing home chores. \
  3. User interface is complicated. It cannot be used easily by old aged users.  \
  4. It is designed for unisex use. \
  5. Fitbit may be an inconvenience to wear during sleep and while performing household chores. \

### Answers to questions 
1.  What are the current trends in smart device usage? \
    \
    Each user is a unique individual hence they do not show identical behavior with respect to daily activities. \
    \
    Users can be divided into several segments based on their daily activity. They are:\
    (a) Users with light activity, (b) Users with moderate activity, (c) Users with heavy activity. Among these groups, users with light and moderate activity are the most common. \
    Users showed tendencies to move more on Sundays, Mondays and Tuesdays. This suggests (a) Users move more on Sunday weekend activities such as going on hike/treks/shopping, (b) High movement on Mondays and Tuesdays can be attributed to user excitement in doing exercises at the start of the week. \
    Average daily distance moved by users is 5 units.\
    Users moved an average of 7519 steps and burned 2282 calories daily. \
    \
    Users exhibit movement between 8 am and 10 pm daily.
    \
    Very few users do intensive physical activities or walk more than 20k steps daily (In the current case 2). \
    \
    Not many users have reported sleep activity. This may be due to charging of Fitbit battery or inconvenience in wearing it during sleep. \
    \
    Fewer heart rate and sleep data suggests users are mainly keen on recording their daily activity (steps, intensities and calories).\
\

2.  How could these trends apply to Bellabeat customers? \
    \
    Bellabeat is a company aimed towards women centric fitness devices.\
    \
    The current study suggests that every user has a different activity regime and use of fitness devices. Bellabeat customers are also going to exhibit similar traits. The individuality of each user and Bellabeat app's advices for women based on their individual vitals must be highlighted in the marketing campaign. 
    \
   
3.  How could these trends influence Bellabeat Marketing strategy? \
  \
    Bellabeat marketing strategy must be designed towards encouraging the holistic development of individuals (physical and physiological) by the use of their fitness devices.  Bellabeat must promote the women-centric goal it thrives on. Bellabeat must provide the reasons for being fit as a women and statistics on current health challenges among women. Bellabeat's marketing campaign must stress that being fit is the most natural way to overcome these challenges. It should work around making more and more women conscious of their physical and psychological well being. The marketing campaign must highlight aspects like wellness, readiness score and fifth vital sign provided by its products.\
    \
    The individuality of each user and Bellabeat app's advices for women based on their individual vitals must be highlighted in the marketing campaign.      \
    \
    Bellabeat Leaf products such as pendant or clip is not worn on the hand. Hence, less likely that it interferes during sleep or other daily home chores. This feature should be highlighted towards marketing products like Bellabeat Leaf. \ 
    \
    \
    The fact that people move more only on few days (Sunday, Monday and Tuesday) in the current study, should be used by Bellabeat to promote daily exercises and their importance. The analytics provided by Bellabeat's app should be used to promote more activeness among users. This can be done by giving badges.  \
    \
    Bellabeat marketing team should focus on promoting women's well being while stating the use of Bellabeat's products. Bellabeat products must be promoted as to being synonymous to better health and well being. \
    \
    The marketing team may explain all the features of their products elaborately as slides/and documentation on its website and compare its superiority to existing products. \
    \
    
## Act
  The observations from the current analyses can help in the marketing strategy of Bellabeat app, Leaf and Time products. \
  The following are few main suggestions would help in marketing and future proofing Bellabeat products: \
  1. Individuality of users should be preserved providing users with individual-centric profiles to set their daily activity goals. Bellabeat app's advices for women based on their individual vitals must be highlighted.\
  2. The marketing team may explain all the features of their products elaborately as slides/and documentation on its website and compare its superiority to existing products. \
  3. Regular wearing of device must be encouraged by providing daily/weekly health analytics to the user. \ 
  4. The Bellabeat app can give badges to user based on their weekly/monthly achievements. \ 
  5. Users with 100+ days activity streak or many number of badges can be given discounts on personal trainer services, nutrition guidance or other Bellabeat products such as Spring. \
  6. Bellabeat device should have a provision for users to record/set sleep or work hours so that the fitness device does not prompt them to move when they are busy. It can also provide a facility to integrate with their daily calendars. \
  7. Bellabeat products can also have special functions to record household chores as daily activities. \
  8. User interface must be made friendly for users of all age groups. It should be simplified for users 65 years and above. \
  9. Bellabeat can come up with a product specifically designed for individuals/women above the age of 65 years. \
  10. Bellabeat's campaign should work around making more and more women conscious of their physical and psychological well being. \
  11. Modern lifestyle leads to a lot of complications in female reproductive health. Bellabeat membership service can integrate services provided by psychiatrists and gynecologists. The data and analytics provided by the Bellabeat app can help psychiatrists, nutritionists and gynecologists in providing better lifestyle advises to women. \
  12. Bellabeat membership service can also team up with fitness trainers to provide specialized videos of exercises, weight training, resistance band workouts, dance and yoga for users of beginner, intermediate and advanced levels. \
  13. Bellabeat can launch personalized fitness products like weights, resistance bands, exercise balls, workout apparel for users.\
  14. Currently bracelets straps, pendant, chain, watch have limited design and color variations. Increasing variety pendant design or replaceable pendant/bracelet stones/bracelet straps could make it an accessory for users to pair with variety of their dresses. This would encourage the user to wear Bellabeat devices more than often. \  




